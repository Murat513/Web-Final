<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–æ–∑–¥–∞—Ç—å –∫—É—Ä—Å - Online Courses Platform</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <a href="/" class="logo">üéì EduPlatform</a>
            <div class="nav-links">
                <a href="/">–ì–ª–∞–≤–Ω–∞—è</a>
                <a href="/courses.html">–ö—É—Ä—Å—ã</a>
                <a href="/dashboard.html">–ú–æ–∏ –∫—É—Ä—Å—ã</a>
                <a href="/create-course.html" class="active">–°–æ–∑–¥–∞—Ç—å –∫—É—Ä—Å</a>
                <div class="auth-buttons" id="auth-buttons">
                    <button onclick="logout()" class="btn btn-outline">–í—ã–π—Ç–∏</button>
                </div>
            </div>
        </div>
    </nav>

    <div class="container">
        <h1>–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∫—É—Ä—Å</h1>
        
        <form id="create-course-form" class="create-course-form">
            <div class="form-section">
                <h2>–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h2>
                
                <div class="form-group">
                    <label for="course-title">–ù–∞–∑–≤–∞–Ω–∏–µ –∫—É—Ä—Å–∞ *</label>
                    <input type="text" id="course-title" name="title" required>
                </div>
                
                <div class="form-group">
                    <label for="course-description">–û–ø–∏—Å–∞–Ω–∏–µ –∫—É—Ä—Å–∞ *</label>
                    <textarea id="course-description" name="description" rows="4" required></textarea>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="course-category">–ö–∞—Ç–µ–≥–æ—Ä–∏—è *</label>
                        <select id="course-category" name="category" required>
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
                            <option value="programming">–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ</option>
                            <option value="design">–î–∏–∑–∞–π–Ω</option>
                            <option value="business">–ë–∏–∑–Ω–µ—Å</option>
                            <option value="marketing">–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥</option>
                            <option value="languages">–Ø–∑—ã–∫–∏</option>
                            <option value="other">–î—Ä—É–≥–æ–µ</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="course-level">–£—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ *</label>
                        <select id="course-level" name="level" required>
                            <option value="beginner">–ù–∞—á–∏–Ω–∞—é—â–∏–π</option>
                            <option value="intermediate">–°—Ä–µ–¥–Ω–∏–π</option>
                            <option value="advanced">–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="course-price">–¶–µ–Ω–∞ ($) *</label>
                        <input type="number" id="course-price" name="price" min="0" value="0" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="course-duration">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (—á–∞—Å—ã) *</label>
                        <input type="number" id="course-duration" name="duration" min="1" value="10" required>
                    </div>
                </div>
            </div>

            <div class="form-section">
                <h2>–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</h2>
                
                <div class="form-group">
                    <label for="course-requirements">–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è (–∫–∞–∂–¥–æ–µ —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏)</label>
                    <textarea id="course-requirements" name="requirements" rows="3" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä:
–ë–∞–∑–æ–≤—ã–µ –∑–Ω–∞–Ω–∏—è –∫–æ–º–ø—å—é—Ç–µ—Ä–∞
–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="course-outcomes">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—É—á–µ–Ω–∏—è (–∫–∞–∂–¥–æ–µ —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏)</label>
                    <textarea id="course-outcomes" name="learningOutcomes" rows="3" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä:
–ù–∞—É—á–∏—Ç–µ—Å—å —Å–æ–∑–¥–∞–≤–∞—Ç—å –≤–µ–±-—Å–∞–π—Ç—ã
–ü–æ–π–º–µ—Ç–µ –æ—Å–Ω–æ–≤—ã JavaScript"></textarea>
                </div>
            </div>

            <div class="form-actions">
                <button type="submit" class="btn btn-primary btn-lg">–°–æ–∑–¥–∞—Ç—å –∫—É—Ä—Å</button>
                <button type="button" onclick="window.location.href='/dashboard.html'" class="btn btn-outline">–û—Ç–º–µ–Ω–∞</button>
            </div>
            
            <div id="message" class="message"></div>
        </form>
    </div>

    <script>
            document.getElementById('create-course-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = {
                title: document.getElementById('course-title').value,
                description: document.getElementById('course-description').value,
                category: document.getElementById('course-category').value,
                level: document.getElementById('course-level').value,
                price: parseFloat(document.getElementById('course-price').value),
                duration: parseInt(document.getElementById('course-duration').value),
                requirements: document.getElementById('course-requirements').value.split('\n').filter(line => line.trim()),
                learningOutcomes: document.getElementById('course-outcomes').value.split('\n').filter(line => line.trim())
            };
            
            try {
                const response = await fetch('http://localhost:5000/api/courses', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    credentials: 'include',
                    body: JSON.stringify(formData)
                });
                
                const data = await response.json();
                const messageDiv = document.getElementById('message');
                
                if (data.success) {
                    messageDiv.className = 'message success';
                    messageDiv.innerHTML = `
                        <p>‚úÖ –ö—É—Ä—Å —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!</p>
                        <p>ID –∫—É—Ä—Å–∞: ${data.course?.id}</p>
                        <a href="/dashboard.html" class="btn btn-primary">–ü–µ—Ä–µ–π—Ç–∏ –∫ –º–æ–∏–º –∫—É—Ä—Å–∞–º</a>
                    `;
                    
                    document.getElementById('create-course-form').reset();
                    document.getElementById('youtube-info').innerHTML = '';
                } else {
                    messageDiv.className = 'message error';
                    messageDiv.textContent = `‚ùå –û—à–∏–±–∫–∞: ${data.message}`;
                }
            } catch (error) {
                console.error('Error creating course:', error);
                document.getElementById('message').className = 'message error';
                document.getElementById('message').textContent = '‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É.';
            }
        });

        
        async function checkAuth() {
            try {
                const response = await fetch('/api/auth/check', {
                    credentials: 'include'
                });
                const data = await response.json();
                
                const authButtons = document.getElementById('auth-buttons');
                if (!authButtons) return;
                
                if (data.isAuthenticated) {
                    authButtons.innerHTML = `
                        <span>–ü—Ä–∏–≤–µ—Ç, ${data.user.username}!</span>
                        <a href="/dashboard.html" class="btn btn-outline">–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</a>
                        <button onclick="logout()" class="btn btn-outline">–í—ã–π—Ç–∏</button>
                    `;
                } else {
                    window.location.href = '/login.html';
                }
            } catch (error) {
                console.error('Auth check error:', error);
                window.location.href = '/login.html';
            }
        }

        async function logout() {
            try {
                await fetch('/api/auth/logout', {
                    method: 'POST',
                    credentials: 'include'
                });
                window.location.href = '/';
            } catch (error) {
                console.error('Logout error:', error);
                window.location.href = '/';
            }
        }

        document.addEventListener('DOMContentLoaded', checkAuth);
    </script>
</body>
</html>